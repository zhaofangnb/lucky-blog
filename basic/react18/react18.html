<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>个人博客 | 个人博客</title>
    <meta name="description" content="lucky-zf的个人博客,专注分享前端知识">
    <link rel="preload stylesheet" href="/lucky-blog/assets/style.4107d5cb.css" as="style">
    <link rel="modulepreload" href="/lucky-blog/assets/app.008430f5.js">
    <link rel="modulepreload" href="/lucky-blog/assets/basic_react18_react18.md.51ff2beb.lean.js">
    
    <link rel="icon" type="image/svg+xml" href="logo.svg">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-9f5be689><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d0af764a></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-d0af764a> Skip to content </a><!--]--><!----><header class="VPNav" data-v-9f5be689 data-v-3948bc9a><div class="VPNavBar has-sidebar" data-v-3948bc9a data-v-69b28da3><div class="container" data-v-69b28da3><div class="title" data-v-69b28da3><div class="VPNavBarTitle has-sidebar" data-v-69b28da3 data-v-74196ede><a class="title" href="/lucky-blog/" data-v-74196ede><!--[--><!--]--><!--[--><img class="VPImage logo" src="/lucky-blog/avator.jpg" alt data-v-42cfc77b><!--]--><!--[-->个人博客<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-69b28da3><div class="curtain" data-v-69b28da3></div><div class="content-body" data-v-69b28da3><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-69b28da3 data-v-6de33a3e><span id="main-nav-aria-label" class="visually-hidden" data-v-6de33a3e>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/lucky-blog/basic/" data-v-6de33a3e data-v-13242a03 data-v-62ceb7b4><!--[-->入门篇<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/lucky-blog/advance/" data-v-6de33a3e data-v-13242a03 data-v-62ceb7b4><!--[-->进阶篇<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/lucky-blog/interview/" data-v-6de33a3e data-v-13242a03 data-v-62ceb7b4><!--[-->面试篇<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-69b28da3 data-v-7333ae8b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-7333ae8b data-v-87c29fae data-v-3fbbfcaf><span class="check" data-v-3fbbfcaf><span class="icon" data-v-3fbbfcaf><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-87c29fae><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-87c29fae><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-69b28da3 data-v-912859e4 data-v-8536dd63><!--[--><a class="VPSocialLink" href="https://gitee.com/lucky-zhaofang" target="_blank" rel="noopener" data-v-8536dd63 data-v-04e1ff9f><svg t="1675837057998" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1407" width="200" height="200"><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z" fill="#C71D23" p-id="1408"></path></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-69b28da3 data-v-2fa4d5cc data-v-a076315d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-a076315d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-a076315d><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-a076315d><div class="VPMenu" data-v-a076315d data-v-ab4f8eb2><!----><!--[--><!--[--><!----><div class="group" data-v-2fa4d5cc><div class="item appearance" data-v-2fa4d5cc><p class="label" data-v-2fa4d5cc>Appearance</p><div class="appearance-action" data-v-2fa4d5cc><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-2fa4d5cc data-v-87c29fae data-v-3fbbfcaf><span class="check" data-v-3fbbfcaf><span class="icon" data-v-3fbbfcaf><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-87c29fae><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-87c29fae><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-2fa4d5cc><div class="item social-links" data-v-2fa4d5cc><div class="VPSocialLinks social-links-list" data-v-2fa4d5cc data-v-8536dd63><!--[--><a class="VPSocialLink" href="https://gitee.com/lucky-zhaofang" target="_blank" rel="noopener" data-v-8536dd63 data-v-04e1ff9f><svg t="1675837057998" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1407" width="200" height="200"><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z" fill="#C71D23" p-id="1408"></path></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-69b28da3 data-v-8a0fd99b><span class="container" data-v-8a0fd99b><span class="top" data-v-8a0fd99b></span><span class="middle" data-v-8a0fd99b></span><span class="bottom" data-v-8a0fd99b></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-9f5be689 data-v-c1c63e26><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-c1c63e26><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-c1c63e26><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-c1c63e26>Menu</span></button><a class="top-link" href="#" data-v-c1c63e26>Return to top</a></div><aside class="VPSidebar" data-v-9f5be689 data-v-ed0f871d><div class="curtain" data-v-ed0f871d></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ed0f871d><span class="visually-hidden" id="sidebar-aria-label" data-v-ed0f871d> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ed0f871d><section class="VPSidebarItem level-0 collapsible has-active" data-v-ed0f871d data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h2 class="text" data-v-2568f505>入门篇</h2><!--]--><!----></a><div class="caret" role="button" data-v-2568f505><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-2568f505><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-2568f505><!--[--><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>HTML5</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/html5/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>HTML新特性</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/html5/browser.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>浏览器</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/html5/a.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>a标签</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>CSS3</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/css3/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>CSS3新特性</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/css3/layout.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>常见css布局</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/css3/flex.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>flex问题</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/css3/center.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>center居中</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/css3/triangle.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>三角形</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/css3/scss.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>scss语法</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>JavaScript</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/javascript/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>简介</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/javascript/readExcelToJson.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>前端解析XLSX</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/javascript/pdf.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>导出pdf并预览</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/javascript/window.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>window窗口</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/javascript/offset.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>offset偏移</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>Canvas</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/canvas/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>canvas基础</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/canvas/applycation.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>canvas应用案例</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>Vue2</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/vue2/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>简介</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/vue2/yuanma.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>vue2源码</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>Vue3</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/vue3/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>基础知识</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/vue3/lightpoint.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>七大亮点</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/vue3/pinia.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>pinia</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 has-active" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>React18</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/react18/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>简介</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link is-active has-active" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/react18/react18.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>React18新特性</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/react18/hoc.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>HOC高阶组件</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/react18/hooks.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>Hooks</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>微信小程序</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>简介</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/diffrent.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>小程序与uniapp的区别</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/lifecycle.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>小程序生命周期</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/jump.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>小程序路由跳转</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/login.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>小程序登录</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/pay.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>小程序支付</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/wechat/performance.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>小程序性能</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>Uniapp</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/uniapp/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>简介</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-2568f505 data-v-2568f505><div class="item" role="button" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link" data-v-2568f505 data-v-62ceb7b4><!--[--><h3 class="text" data-v-2568f505>Axios</h3><!--]--><!----></a><!----></div><div class="items" data-v-2568f505><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/axios/" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>基础知识</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/axios/exportMethod.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>前端文件流下载</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2568f505 data-v-2568f505><div class="item" data-v-2568f505><div class="indicator" data-v-2568f505></div><a class="VPLink link link" href="/lucky-blog/basic/axios/contentType.html" data-v-2568f505 data-v-62ceb7b4><!--[--><p class="text" data-v-2568f505>Content-Type</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-9f5be689 data-v-a4959631><div class="VPDoc has-sidebar has-aside" data-v-a4959631 data-v-2bc14cba><div class="container" data-v-2bc14cba><div class="aside" data-v-2bc14cba><div class="aside-curtain" data-v-2bc14cba></div><div class="aside-container" data-v-2bc14cba><div class="aside-content" data-v-2bc14cba><div class="VPDocAside" data-v-2bc14cba data-v-79f50d30><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-79f50d30 data-v-a888dac8><div class="content" data-v-a888dac8><div class="outline-marker" data-v-a888dac8></div><div class="outline-title" data-v-a888dac8>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-a888dac8><span class="visually-hidden" id="doc-outline-aria-label" data-v-a888dac8> Table of Contents for current page </span><ul class="root" data-v-a888dac8 data-v-b7eb0432><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-79f50d30></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-2bc14cba><div class="content-container" data-v-2bc14cba><!--[--><!--]--><main class="main" data-v-2bc14cba><div style="position:relative;" class="vp-doc _lucky-blog_basic_react18_react18" data-v-2bc14cba><div><h2 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-hidden="true">#</a></h2><p><code>React 18</code>已经放弃了对<code>ie 11</code>的支持，如需兼容，需要回退到<code>React 17</code>版本</p><p>##　升级 新项目：直接用<code>npm</code> 或者 <code>yarn</code> 安装最新版依赖</p><p>React 18 中引入的新特性是使用现代浏览器的特性构建的，在IE中无法充分polyfill，比如micro-tasks</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm i react react</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dom </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">save</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i </span><span style="color:#89DDFF;">@</span><span style="color:#A6ACCD;">types</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">react </span><span style="color:#89DDFF;">@</span><span style="color:#A6ACCD;">types</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">react</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dom </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">D</span></span>
<span class="line"></span></code></pre></div><p>旧项目: 先把依赖中的版本号改成最新，然后删掉node_modules文件夹，重新安装</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">npm i</span></span>
<span class="line"></span></code></pre></div><h2 id="新特性" tabindex="-1">新特性 <a class="header-anchor" href="#新特性" aria-hidden="true">#</a></h2><h3 id="render-api" tabindex="-1">Render API <a class="header-anchor" href="#render-api" aria-hidden="true">#</a></h3><p>为了更好的管理<code>root节点</code>，React 18 引入了一个新的 <code>root API</code>，新的 root API 还支持<code> new concurrent renderer（并发模式的渲染）</code>，它允许你进入<code>concurrent mode（并发模式）</code>。</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 17</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ReactDOM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> App </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./App</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> root </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">!;</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">render</span><span style="color:#A6ACCD;">(&lt;</span><span style="color:#FFCB6B;">App</span><span style="color:#A6ACCD;"> /&gt;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> root)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// React 18</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ReactDOM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom/client</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> App </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./App</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> root </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">!;</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createRoot</span><span style="color:#A6ACCD;">(root)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">render</span><span style="color:#A6ACCD;">(&lt;</span><span style="color:#FFCB6B;">App</span><span style="color:#A6ACCD;"> /&gt;)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>卸载组件:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 17</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDom</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">unmountComponentAtNode</span><span style="color:#A6ACCD;">(root)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// React 18</span></span>
<span class="line"><span style="color:#A6ACCD;">root</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">unmount</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>如果需要在<code>render</code>方法中使用回调函数:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 17</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> root </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">!</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">render</span><span style="color:#A6ACCD;">(&lt;</span><span style="color:#FFCB6B;">App</span><span style="color:#A6ACCD;"> /&gt;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> root</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">渲染完成</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// React 18</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> AppWithCallback</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">useEffect</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">渲染完成</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> [])</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">App</span><span style="color:#F07178;"> /</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">}</span></span>
<span class="line"><span style="color:#F07178;">const root = document.getElementById(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">!;</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createRoot</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">root</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">render</span><span style="color:#F07178;">(&lt;</span><span style="color:#FFCB6B;">AppWithCallback</span><span style="color:#F07178;"> /&gt;)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>如果你的项目使用了<code>ssr服务端渲染</code>，需要把hydration升级为hydrateRoot</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 17</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ReactDOM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> root </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hydrate</span><span style="color:#A6ACCD;">(&lt;</span><span style="color:#FFCB6B;">App</span><span style="color:#A6ACCD;"> /&gt;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> root)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// React 18</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> ReactDOM </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom/client</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> root </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">!;</span></span>
<span class="line"><span style="color:#A6ACCD;">ReactDOM</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hydrateRoot</span><span style="color:#A6ACCD;">(root</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> &lt;</span><span style="color:#FFCB6B;">App</span><span style="color:#A6ACCD;"> /&gt;)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>如果你的项目使用了<code>TypeScrip</code>t，最值得注意的变化是，现在在<code>定义props类型</code>时，如果需要<code>获取子组件children</code>，那么你需要<code>显式的定义它</code>:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 17</span></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyButtonProps</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> MyButton</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">MyButtonProps</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">children</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 在 React 17 的 FC 中，默认携带了 children 属性</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> MyButton</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// React 18</span></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MyButtonProps</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">children</span><span style="color:#89DDFF;">?:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">ReactNode</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> MyButton</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">MyButtonProps</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">children</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 在 React 18 的 FC 中，不存在 children 属性，需要手动申明</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">children</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> MyButton</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="setstate自动批处理" tabindex="-1">setState自动批处理 <a class="header-anchor" href="#setstate自动批处理" aria-hidden="true">#</a></h3><p>批处理是指为了获得更好的性能，在数据层，<code>将多个状态更新批量处理，合并成一次更新</code>（在视图层，将多个渲染合并成一次渲染）</p><blockquote><p>setState更新状态的2种写法</p></blockquote><p>(1). setState(stateChange, [callback]) ------<code>对象式的</code>setState 1.stateChange为状态改变对象(该对象可以体现出状态的更改) 2.callback是<code>可选</code>的回调函数, 它在状态更新完毕、界面也更新后(render调用后)才被调用</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">count</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> count</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;">；</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>(2). setState(updater, [callback]) ------<code>函数式的</code>setState 1.updater为返回stateChange对象的函数。 2.updater可以接收到<code>state</code>和<code>props</code>。 4.callback是<code>可选</code>的回调函数, 它在状态更新、界面也更新后(render调用后)才被调用。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setState</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">state</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">props</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    count</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>总结: 1.对象式的setState是函数式的setState的简写方式(语法糖) 2.使用原则： (1).如果新状态不依赖于原状态 ===&gt; 使用对象方式 (2).如果新状态依赖于原状态 ===&gt; 使用函数方式 (3).如果需要在setState()执行后获取最新的状态数据, 要在第二个callback函数中读取</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Component</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Demo</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Component</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">state</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">count</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 对象式</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">  </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span><span style="color:#F07178;">；</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#F07178;">setState(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      count</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">++</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 函数式</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#F07178;">setState(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">state</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">props</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        count</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">render</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">当前总和为: </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">state</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">count </span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#F07178;">h2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">onClick</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">add </span><span style="color:#89DDFF;">}&gt;</span><span style="color:#A6ACCD;"> 点击+1 </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="在react-18-之前" tabindex="-1">在React 18 之前 <a class="header-anchor" href="#在react-18-之前" aria-hidden="true">#</a></h4><p>在React 18 之前，我们<code>只在 React 事件处理函数 中进行批处理更新</code>。默认情况下，在promise、setTimeout、原生事件处理函数中、或任何其它事件内的更新都不会进行批处理：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 1. React 事件处理函数</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">App组件被渲染了</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount1</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount2</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">button</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">onClick</span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">() =&gt; {</span></span>
<span class="line"><span style="color:#F07178;">            setCount1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;">;</span></span>
<span class="line"><span style="color:#F07178;">            setCount2</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;">;</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// 在React事件中被批处理</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}&gt;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">`</span><span style="color:#A6ACCD;font-style:italic;">count1</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">is</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">$</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count1</span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">count2</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">is</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">$</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count2</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">`</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 2. setTimeout</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">App组件渲染了！</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount1</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount2</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;font-style:italic;">div</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">onClick</span><span style="color:#89DDFF;">={</span><span style="color:#F07178;">() =&gt; {</span></span>
<span class="line"><span style="color:#F07178;">        setTimeout</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          setCount1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#F07178;">          setCount2</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 在 setTimeout 中不会进行批处理</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#A6ACCD;">count1</span><span style="color:#F07178;">： </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count1</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#A6ACCD;">count2</span><span style="color:#F07178;">： </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count2</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 3. 原生js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">App组件渲染了！</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount1</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount2</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">useEffect</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">click</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">setCount1</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">setCount2</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 在原生js事件中不会进行批处理</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> [])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;&gt;</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#A6ACCD;">count1</span><span style="color:#F07178;">： </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count1</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#A6ACCD;">count2</span><span style="color:#F07178;">： </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count2</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;/&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h4 id="在react-18-之中" tabindex="-1">在React 18 之中 <a class="header-anchor" href="#在react-18-之中" aria-hidden="true">#</a></h4><p>在 <code>React 18 </code>上面的三个例子<code>只会有一次 render</code>，因为所有的更新都将自动批处理,多次更新始终合并为依次。</p><h3 id="flushsync" tabindex="-1">flushSync <a class="header-anchor" href="#flushsync" aria-hidden="true">#</a></h3><p>批处理是一个破坏性改动，如果你想<code>退出批量更新</code>，你可以使用 <code>flushSync</code>：</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">flushSync</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount1</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count2</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount2</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;font-style:italic;">div</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">onClick</span><span style="color:#89DDFF;">={</span><span style="color:#F07178;">() =&gt; {</span></span>
<span class="line"><span style="color:#F07178;">        flushSync</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          setCount1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">);</span><span style="color:#676E95;font-style:italic;">// 第一次更新</span></span>
<span class="line"><span style="color:#F07178;">        flushSync</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          setCount2</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">);</span><span style="color:#676E95;font-style:italic;">// 第二次更新</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#A6ACCD;">count1</span><span style="color:#F07178;">： </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count1</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">div</span><span style="color:#F07178;">&gt;</span><span style="color:#A6ACCD;">count2</span><span style="color:#F07178;">： </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">count2</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="关于react组件的返回值" tabindex="-1">关于React组件的返回值 <a class="header-anchor" href="#关于react组件的返回值" aria-hidden="true">#</a></h2><p>在 React 17 中，如果你需要<code>返回一个空组件，React只允许返回null</code>。如果你显式的返回了 undefined，控制台则会在运行时抛出一个错误。</p><p>在 React 18 中，不再检查因返回 undefined 而导致崩溃。<code>既能返回 null，也能返回 undefined</code>（但是 React 18 的dts文件还是会检查，只允许返回 null，你可以忽略这个类型错误）。</p><h2 id="严格模式strict-mode" tabindex="-1">严格模式Strict Mode <a class="header-anchor" href="#严格模式strict-mode" aria-hidden="true">#</a></h2><p>当你<code>使用严格模式时，React 会对每个组件进行两次渲染，以便你观察一些意想不到的结果</code>。在 React 17 中，取消了其中一次渲染的控制台日志，以便让日志更容易阅读。 在 React 18 中，官方取消了这个限制。如果你安装了React DevTools，第二次渲染的日志信息将显示为灰色，以柔和的方式显式在控制台。 <img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e7c1a0da9d824e2ba2ef7b9af32fbc91~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt=""></p><p>##　Supense 不再需要 fallback 来捕获</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 17</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">Suspense</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fallback</span><span style="color:#89DDFF;">={</span><span style="color:#F07178;">&lt;Loading /&gt;</span><span style="color:#89DDFF;">}&gt;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// &lt;--- 这个边界被使用，显示 Loading 组件</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">Suspense</span><span style="color:#F07178;">&gt;                      </span><span style="color:#676E95;font-style:italic;">// &lt;--- 这个边界被跳过，没有 fallback 属性</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">Page</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">Suspense</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">Suspense</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// React 18</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">Suspense</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fallback</span><span style="color:#89DDFF;">={</span><span style="color:#F07178;">&lt;Loading /&gt;</span><span style="color:#89DDFF;">}&gt;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// &lt;--- 不使用</span></span>
<span class="line"><span style="color:#F07178;">      &lt;</span><span style="color:#FFCB6B;">Suspense</span><span style="color:#F07178;">&gt;                      </span><span style="color:#676E95;font-style:italic;">// &lt;--- 这个边界被使用，将 fallback 渲染为 null</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">Page</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">Suspense</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#A6ACCD;">Suspense</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="新的api" tabindex="-1">新的API <a class="header-anchor" href="#新的api" aria-hidden="true">#</a></h2><p>###　useId 因为我们的服务器渲染时提供的 HTML 是无序的，useId 的原理就是每个 id 代表该组件在组件树中的层级结构</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useId</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><h3 id="usesyncexternalstore" tabindex="-1">useSyncExternalStore <a class="header-anchor" href="#usesyncexternalstore" aria-hidden="true">#</a></h3><h2 id="并发特性" tabindex="-1">并发特性 <a class="header-anchor" href="#并发特性" aria-hidden="true">#</a></h2><h3 id="starttransition" tabindex="-1">startTransition <a class="header-anchor" href="#starttransition" aria-hidden="true">#</a></h3><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useEffect</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useTransition</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">list</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setList</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">any</span><span style="color:#F07178;">[]</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;">[]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">isPending</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">startTransition</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useTransition</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">useEffect</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//使用了并发特性，开启并发更新</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">startTransition</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">setList</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Array</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">10000</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fill</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">null</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> [])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;&gt;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#A6ACCD;font-style:italic;">list</span><span style="color:#F07178;">.</span><span style="color:#A6ACCD;font-style:italic;">map</span><span style="color:#F07178;">((</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">i</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">                </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">div</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">}&gt;{</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">            ))</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;/&gt;</span></span>
<span class="line"><span style="color:#F07178;">    )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>startTransition，主要为了能在大量的任务下也能保持 UI 响应。<br><code>被startTransition 回调包裹的 setState 触发的渲染被标记为不紧急渲染，这些渲染可能被其他紧急渲染所抢占</code>。</p><h3 id="usedeferredvalue" tabindex="-1">useDeferredValue <a class="header-anchor" href="#usedeferredvalue" aria-hidden="true">#</a></h3><p>返回一个延迟响应的值，可以让一个state 延迟生效，只有当前没有紧急更新时，该值才会变为最新值。useDeferredValue 和 startTransition 一样，都是标记了一次非紧急更新。</p><p>相同：<code>useDeferredValue</code> 本质上和内部实现与 <code>useTransition</code> 一样，都是标记成了延迟更新任务。 不同：<code>useTransition</code> 是把更新任务变成了延迟更新任务，而 <code>useDeferredValue</code> 是产生一个新的值，这个值作为延时状态。（一个用来包装方法，一个用来包装值）</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useEffect</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useDefferedValue</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">list</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setList</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useState</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">any</span><span style="color:#F07178;">[]</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;">[]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">useEffect</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">setList</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Array</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">10000</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fill</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">null</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> [])</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 使用了并发特性，开启并发更新</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">deferredList</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useDeferredValue</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">list</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;&gt;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;font-style:italic;">deferredList</span><span style="color:#F07178;">.</span><span style="color:#A6ACCD;font-style:italic;">map</span><span style="color:#F07178;">((</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">i</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">div</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">key</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">}&gt;{</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">}&lt;/</span><span style="color:#A6ACCD;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">      ))</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;/&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-hidden="true">#</a></h3><p>并发更新的意义就是<code>交替执行</code>不同的任务，当预留的时间不够用时，<code>React </code>将线程控制权交还给浏览器，等待下一帧时间到来，然后继续被中断的工作</p><p><code>并发模式</code>是实现<code>并发更新</code>的基本前提</p><p><code>时间切片</code>是实现<code>并发更新</code>的具体手段</p><p>上面所有的东西都是基于 <code>fiber</code> 架构实现的，fiber为状态更新提供了可中断的能力</p><h3 id="关于fiber" tabindex="-1">关于fiber <a class="header-anchor" href="#关于fiber" aria-hidden="true">#</a></h3><p>作为<code>架构</code>来说，在旧的架构中，Reconciler（协调器）采用递归的方式执行，无法中断，节点数据保存在递归的调用栈中，被称为<code> Stack Reconciler</code>，stack 就是调用栈；在新的架构中，<code>Reconciler（协调器）</code>是基于fiber实现的，节点数据保存在fiber中，所以被称为<code> fiber Reconciler</code>。</p><p>作为<code>静态数据结构</code>来说，每个fiber对应一个组件，保存了这个组件的类型对应的dom节点信息，这个时候，fiber节点就是我们所说的虚拟DOM。</p><p>作为<code>动态工作单元</code>来说，fiber节点保存了该节点需要更新的状态，以及需要执行的副作用。</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-2bc14cba data-v-f1c9b43a><!----><div class="prev-next" data-v-f1c9b43a><div class="pager" data-v-f1c9b43a><a class="pager-link prev" href="/lucky-blog/basic/react18/" data-v-f1c9b43a><span class="desc" data-v-f1c9b43a>上一页</span><span class="title" data-v-f1c9b43a>简介</span></a></div><div class="has-prev pager" data-v-f1c9b43a><a class="pager-link next" href="/lucky-blog/basic/react18/hoc.html" data-v-f1c9b43a><span class="desc" data-v-f1c9b43a>下一页</span><span class="title" data-v-f1c9b43a>HOC高阶组件</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-9f5be689 data-v-5d98ef4f><div class="container" data-v-5d98ef4f><p class="message" data-v-5d98ef4f>Released under the MIT License.</p><p class="copyright" data-v-5d98ef4f>Copyright © 2023-present lucky zhaofang</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"interview_algorithm_insertion_sort.md\":\"2d17b484\",\"advance_harmonyos_index.md\":\"7ba2f88e\",\"advance_harmonyos_slot.md\":\"af326ed0\",\"advance_index.md\":\"b443068f\",\"advance_harmonyos_layout.md\":\"da12cb60\",\"interview_algorithm_index.md\":\"ce50580b\",\"interview_algorithm_merge_sort.md\":\"5961e5de\",\"advance_harmonyos_customdialog.md\":\"8226d307\",\"advance_typescript_function.md\":\"2f5f078c\",\"advance_nuxt3_index.md\":\"ac0ef4a9\",\"advance_typescript_assert.md\":\"7a4c1a7c\",\"advance_typescript_class.md\":\"1b06aa0f\",\"basic_vue3_responsive.md\":\"9b9dc668\",\"advance_harmonyos_codereuse.md\":\"6c884d4f\",\"advance_nodejs_accurancy.md\":\"6341ded0\",\"advance_webpack5_basicconfig.md\":\"ccc03170\",\"basic_axios_contenttype.md\":\"950d0115\",\"advance_typescript_decoration.md\":\"9155066d\",\"advance_typescript_tsconfig.md\":\"d3a6a0aa\",\"advance_typescript_datatype.md\":\"cd331ec5\",\"advance_nodejs_index.md\":\"97fa17ab\",\"interview_algorithm_queue.md\":\"576fd5aa\",\"basic_axios_index.md\":\"44768b7e\",\"advance_vite_vite2.md\":\"8f067ab9\",\"advance_vite_principle.md\":\"da485aab\",\"advance_typescript_generic.md\":\"923ad3bf\",\"advance_typescript_declare.md\":\"1b0d6d94\",\"basic_canvas_applycation.md\":\"0fe989d8\",\"advance_nodejs_express.md\":\"86c43b20\",\"advance_vite_vite3.md\":\"9e8a7300\",\"advance_vite_viteconfig.md\":\"bad7bbc9\",\"basic_index.md\":\"38af03ed\",\"basic_css3_triangle.md\":\"a5d7bf9f\",\"basic_vue3_lightpoint.md\":\"2ec669d8\",\"basic_uniapp_index.md\":\"7b92da1a\",\"interview_algorithm_assign.md\":\"0e48395a\",\"interview_algorithm_demo.md\":\"943fbc04\",\"basic_wechat_jump.md\":\"985b660b\",\"interview_algorithm_int_reverse_string.md\":\"fb107508\",\"basic_wechat_login.md\":\"6ca4e38a\",\"basic_vue3_pinia.md\":\"6e4f177f\",\"basic_react18_index.md\":\"cef243ea\",\"interview_algorithm_quick_sort.md\":\"782a0fdc\",\"advance_electron_index.md\":\"2c8149db\",\"interview_algorithm_sum_two_num.md\":\"b0a2a736\",\"interview_linux_index.md\":\"e6012a96\",\"basic_vue2_yuanma.md\":\"45a101c0\",\"interview_algorithm_intersection.md\":\"92455ef3\",\"basic_wechat_lifecycle.md\":\"d190acc1\",\"basic_react18_class.md\":\"c0c6fc65\",\"basic_vue2_index.md\":\"e4b46788\",\"basic_wechat_performance.md\":\"b4106423\",\"basic_wechat_index.md\":\"911603e8\",\"interview_algorithm_convert.md\":\"2605405c\",\"advance_vite_index.md\":\"3b6e6b24\",\"basic_wechat_pay.md\":\"58a92a86\",\"interview_algorithm_deep_clone.md\":\"772e930d\",\"interview_algorithm_arr_map.md\":\"0f8a2467\",\"interview_algorithm_heap_sort.md\":\"cb732755\",\"interview_algorithm_buttle_sort.md\":\"c852a02d\",\"basic_react18_hoc.md\":\"cc8e4c13\",\"interview_algorithm_shallow_copy.md\":\"ce8e63aa\",\"interview_algorithm_const.md\":\"d09d9d02\",\"interview_algorithm_match_str.md\":\"c88ad277\",\"advance_typescript_promise.md\":\"8f56c65e\",\"advance_typescript_namespace.md\":\"3c182bb1\",\"basic_css3_flex.md\":\"722a7ae0\",\"advance_webpack5_index.md\":\"b82b802c\",\"advance_typescript_interface.md\":\"6a9f175f\",\"interview_es6_index.md\":\"b0ba6ead\",\"advance_typescript_util.md\":\"622c9c84\",\"basic_vue3_index.md\":\"5fbb9c14\",\"basic_javascript_pdf.md\":\"e5b4d9cd\",\"basic_react18_hooks.md\":\"feefe7ff\",\"interview_npm_index.md\":\"318f05be\",\"basic_wechat_diffrent.md\":\"59a991f3\",\"basic_css3_index.md\":\"a752872e\",\"basic_axios_exportmethod.md\":\"a12379bb\",\"basic_css3_center.md\":\"b3008e64\",\"basic_javascript_index.md\":\"3c476ebc\",\"interview_http_index.md\":\"4efe9a71\",\"basic_react18_react18.md\":\"51ff2beb\",\"basic_html5_a.md\":\"dba8ae11\",\"basic_html5_index.md\":\"1214067b\",\"basic_css3_scss.md\":\"39395f44\",\"interview_live-stream_index.md\":\"5a0d52de\",\"basic_javascript_window.md\":\"d22631b3\",\"advance_typescript_index.md\":\"59a98b66\",\"interview_algorithm_reduce.md\":\"9726dcad\",\"interview_algorithm_random_sort.md\":\"42d211dc\",\"basic_css3_layout.md\":\"8bb6091d\",\"basic_javascript_offset.md\":\"1bf6a332\",\"interview_algorithm_sqrt.md\":\"f4f49d50\",\"index.md\":\"816b8481\",\"basic_html5_browser.md\":\"d3fd5eba\",\"interview_index.md\":\"f1fce678\",\"interview_git_index.md\":\"3dd5b654\",\"interview_algorithm_this.md\":\"1e0a4637\",\"interview_design_index.md\":\"97eb782e\",\"basic_canvas_index.md\":\"3ff6b951\",\"basic_javascript_readexceltojson.md\":\"f797c2ff\"}")</script>
    <script type="module" async src="/lucky-blog/assets/app.008430f5.js"></script>
    
  </body>
</html>